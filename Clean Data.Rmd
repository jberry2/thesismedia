---
title: "Clean"
author: "Joshua Berry"
date: "1/25/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(foreign)
library(haven)
library(tidyverse)
library(readxl)
library(memisc)
library(rstanarm)
library(ggridges)
library(gtsummary)
library(broom.mixed)
library(gt)
library(rockchalk)
```

## R Markdown

```{r}
anes_2016 <- 
read_sav("anes_timeseries_2016.sav") %>%
  as_factor() %>%
  select(V161008, V161009, V162005, V162004, 
         V162003, V162002, V162159, V161270, V161267x,V161310x, V161155) %>%
  rename(V161008 = days_watched_media, V161009 = attention_to_media, 
         V162005 = newspaper_count, V162004 = internet_count, 
         V162003 = radio_count, V162002 = tv_count, 
         V162159 = china_mil_threat, V161270 = education, V161267x = age, 
         V161310x = race, V161155 = party_id) %>%
  mutate(year = 2016) %>%
  mutate(china_mil_scale = case_when(china_mil_threat == "1. Major threat" ~ 1,
                                     china_mil_threat == "2. Minor threat" ~ 1,
                                     china_mil_threat == "3. Not a threat" ~ 0,
                                     TRUE ~ NA_real_)) %>%
  mutate(days_watched_media = case_when(days_watched_media == "0. None" ~ 0,
                                     days_watched_media == "1. One day" ~ 1,
                                     days_watched_media == "2. Two days" ~ 2,
                                     days_watched_media == "3. Three days" ~ 3,
                                     days_watched_media == "4. Four days" ~ 4,
                                     days_watched_media == "5. Five days" ~ 5,
                                     days_watched_media == "6. Six days" ~ 6,
                                     days_watched_media == "7. Seven days" ~ 7,
                                     TRUE ~ NA_real_)) %>%
  mutate(education = case_when(education == "1. Less than 1st grade" ~ 0,
                                     education == "2. 1st, 2nd, 3rd or 4th grade" ~ 1,
                                     education == "3. 5th or 6th grade" ~ 2,
                                     education == "4. 7th or 8th grade" ~ 3,
                                     education == "5. 9th grade" ~ 5,
                                     education == "6. 10th grade" ~ 7,
                                     education == "7. 11th grade" ~ 9,
                                     education == "8. 12th grade no diploma" ~ 11,
                                     education == "9. High school graduate- high school diploma or equivalent (for example: GED)" ~ 15,
                                     education == "10. Some college but no degree" ~ 17,
                                     education == "11. Associate degree in college - occupational /vocational program" ~ 20,
                                     education == "12. Associate degree in college -- academic program" ~ 20,
                                     education == "13. Bachelor's degree (for example: BA, AB, BS)" ~ 25,
                                     education == "14. Master's degree (for example: MA, MS, MENG, MED, MSW, MBA) " ~ 28,
                                     education == "15. Professional school degree (for example: MD, DDS, DVM, LLB, JD)" ~ 31,
                                     education == "16. Doctorate degree (for example: PHD, EDD)" ~ 35,
                                     TRUE ~ NA_real_)) %>%
   mutate(age = case_when(age == "01. Age group 18-20" ~ 0,
                                     age == "02. Age group 21-24" ~ 1,
                                     age == "03. Age group 25-29" ~ 3,
                                     age == "04. Age group 30-34" ~ 6,
                                     age == "05. Age group 35-39" ~ 9,
                                     age == "06. Age group 40-44" ~ 12,
                                     age == "07. Age group 45-49" ~ 15,
                                     age == "08. Age group 50-54" ~ 18,
                                     age == "09. Age group 55-59" ~ 21,
                                     age == "10. Age group 60-64" ~ 24,
                                     age == "11. Age group 65-69" ~ 27,
                                     age == "12. Age group 70-74" ~ 30,
                                     age == "13. Age group 75 or older"  ~ 35,
                                     TRUE ~ NA_real_)) %>%
     mutate(race = case_when(race == "1. White, non-Hispanic" ~ "White",
                                     race == "2. Black, non-Hispanic" ~ "Black",
                                     race == "3. Asian, native Hawaiian or other Pacif Islr,non-Hispanic" ~ "Asian",
                                     race == "5. Hispanic" ~ "Hispanic",
                                     race == "6. Other non-Hispanic incl multiple races [WEB: blank 'Other' counted as a race]" ~ "Other",
                                     race == "4. Native American or Alaska Native, non-Hispanic" ~ "Native American",
                                     TRUE ~ NA_character_)) %>%
       mutate(party_id = case_when(party_id == "1. Democrat" ~ "Democrat",
                                     party_id == "2. Republican" ~ "Republican",
                                     party_id == "3. Independent" ~ "Independent",
                                     TRUE ~ NA_character_))



sixteen.china.mil.glm <- glm(china_mil_scale ~ days_watched_media + education + age + race + party_id,
                     data = anes_2016, family = "binomial")

summary(sixteen.china.mil.glm)
```



```{r}
anes_2012 <- 
read_sav("anes_timeseries_2012.sav") %>%
  as_factor() %>%
  select(prmedia_wkinews, prmedia_atinews, prmedia_wktvnws, prmedia_attvnews, 
         prmedia_wkpaprnws, prmedia_atpprnews, prmedia_wkrdnws, prmedia_atrdnews, dem_racecps_1st, dem_agegrp_iwdate_x, dem_edu, pid_self, china_econ, china_mil, medsrc_socmedia) %>%
    rename(prmedia_wkinews = days_read_internet_news, prmedia_wktvnws = days_watched_tv_news, 
         prmedia_wkpaprnws = days_read_paper_news, prmedia_wkrdnws = days_listened_radio_news,
         medsrc_socmedia = days_read_socmedia_news,
         dem_edu = education, dem_agegrp_iwdate_x = age, 
         dem_racecps_1st = race, pid_self = party_id) %>%
  mutate(year = 2012) %>%
  mutate(china_mil_scale = case_when(china_mil == "1. Major threat" ~ 1,
                                     china_mil == "2. Minor threat" ~ 1,
                                     china_mil == "3. Not a threat" ~ 0,
                                     TRUE ~ NA_real_)) %>%
   mutate(china_econ_scale = case_when(china_econ == "1. Good" ~ 0,
                                     china_econ == "2. Bad" ~ 1,
                                     china_econ == "3. No effect" ~ 0,
                                     TRUE ~ NA_real_)) %>%
  mutate(days_read_internet_news = case_when(days_read_internet_news == "0. None" ~ 0,
                                     days_read_internet_news == "1. One day" ~ 1,
                                     days_read_internet_news == "2. Two days" ~ 2,
                                     days_read_internet_news == "3. Three days" ~ 3,
                                     days_read_internet_news == "4. Four days" ~ 4,
                                     days_read_internet_news == "5. Five days" ~ 5,
                                     days_read_internet_news == "6. Six days" ~ 6,
                                     days_read_internet_news == "7. Seven days" ~ 7,
                                     TRUE ~ NA_real_)) %>%
  mutate(days_watched_tv_news = case_when(days_watched_tv_news == "0. None" ~ 0,
                                     days_watched_tv_news == "1. One day" ~ 1,
                                     days_watched_tv_news == "2. Two days" ~ 2,
                                     days_watched_tv_news == "3. Three days" ~ 3,
                                     days_watched_tv_news == "4. Four days" ~ 4,
                                     days_watched_tv_news == "5. Five days" ~ 5,
                                     days_watched_tv_news == "6. Six days" ~ 6,
                                     days_watched_tv_news == "7. Seven days" ~ 7,
                                     TRUE ~ NA_real_)) %>%
    mutate(days_read_paper_news = case_when(days_read_paper_news == "0. None" ~ 0,
                                     days_read_paper_news == "1. One day" ~ 1,
                                     days_read_paper_news == "2. Two days" ~ 2,
                                     days_read_paper_news == "3. Three days" ~ 3,
                                     days_read_paper_news == "4. Four days" ~ 4,
                                     days_read_paper_news == "5. Five days" ~ 5,
                                     days_read_paper_news == "6. Six days" ~ 6,
                                     days_read_paper_news == "7. Seven days" ~ 7,
                                     TRUE ~ NA_real_)) %>%
      mutate(days_listened_radio_news = case_when(days_listened_radio_news == "0. None" ~ 0,
                                     days_listened_radio_news == "1. One day" ~ 1,
                                     days_listened_radio_news == "2. Two days" ~ 2,
                                     days_listened_radio_news == "3. Three days" ~ 3,
                                     days_listened_radio_news == "4. Four days" ~ 4,
                                     days_listened_radio_news == "5. Five days" ~ 5,
                                     days_listened_radio_news == "6. Six days" ~ 6,
                                     days_listened_radio_news == "7. Seven days" ~ 7,
                                     TRUE ~ NA_real_)) %>%
  mutate(days_read_socmedia_news = case_when(days_read_socmedia_news == "0. None" ~ 0,
                                     days_read_socmedia_news == "1. One day" ~ 1,
                                     days_read_socmedia_news == "2. Two days" ~ 2,
                                     days_read_socmedia_news == "3. Three days" ~ 3,
                                     days_read_socmedia_news == "4. Four days" ~ 4,
                                     days_read_socmedia_news == "5. Five days" ~ 5,
                                     days_read_socmedia_news == "6. Six days" ~ 6,
                                     days_read_socmedia_news == "7. Seven days" ~ 7,
                                     TRUE ~ NA_real_)) %>%
  mutate(education = case_when(education == "1. Less than 1st grade" ~ 0,
                                     education == "2. 1st, 2nd, 3rd or 4th grade" ~ 1,
                                     education == "3. 5th or 6th grade" ~ 2,
                                     education == "4. 7th or 8th grade" ~ 3,
                                     education == "5. 9th grade" ~ 5,
                                     education == "6. 10th grade" ~ 7,
                                     education == "7. 11th grade" ~ 9,
                                     education == "8. 12th grade no diploma" ~ 11,
                                     education == "9. High school graduate- high school diploma or equivalent (for example: GED)" ~ 15,
                                     education == "10. Some college but no degree" ~ 17,
                                     education == "11. Associate degree in college - occupational /vocational program" ~ 20,
                                     education == "12. Associate degree in college -- academic program" ~ 20,
                                     education == "13. Bachelor's degree (for example: BA, AB, BS)" ~ 25,
                                     education == "14. Master's degree (for example: MA, MS, MENG, MED, MSW, MBA) " ~ 28,
                                     education == "15. Professional school degree (for example: MD, DDS, DVM, LLB, JD)" ~ 31,
                                     education == "16. Doctorate degree (for example: PHD, EDD)" ~ 35,
                                     TRUE ~ NA_real_)) %>%
   mutate(age = case_when(age == "01. Age group 17-20" ~ 0,
                                     age == "02. Age group 21-24" ~ 1,
                                     age == "03. Age group 25-29" ~ 3,
                                     age == "04. Age group 30-34" ~ 6,
                                     age == "05. Age group 35-39" ~ 9,
                                     age == "06. Age group 40-44" ~ 12,
                                     age == "07. Age group 45-49" ~ 15,
                                     age == "08. Age group 50-54" ~ 18,
                                     age == "09. Age group 55-59" ~ 21,
                                     age == "10. Age group 60-64" ~ 24,
                                     age == "11. Age group 65-69" ~ 27,
                                     age == "12. Age group 70-74" ~ 30,
                                     age == "13. Age group 75 or older"  ~ 35,
                                     TRUE ~ NA_real_)) %>%
     mutate(race = case_when(race == "01. White" ~ "White",
                                     race == "02. Black or African-American" ~ "Black",
                                     race == "04. Asian" ~ "Asian",
                                     race == "05. Native Hawaiian or other Pacific Islander" ~ "Asian",
                                     race == "03. American Indian or Alaska Native" ~ "Native American",
                                     TRUE ~ NA_character_)) %>%
       mutate(party_id = case_when(party_id == "1. Democrat" ~ "Democrat",
                                     party_id == "2. Republican" ~ "Republican",
                                     party_id == "3. Independent" ~ "Independent",
                                     TRUE ~ NA_character_))



twelve.china.mil.glm <- glm(china_mil_scale ~ days_read_internet_news + days_watched_tv_news + days_read_paper_news + days_listened_radio_news + days_read_socmedia_news + education + age + race + party_id,
                     data = anes_2012, family = "binomial")

summary(twelve.china.mil.glm)

twelve.china.econ.glm <- glm(china_econ_scale ~ days_read_internet_news + days_watched_tv_news + days_read_paper_news + days_listened_radio_news + days_read_socmedia_news + education + age + race + party_id,
                     data = anes_2012, family = "binomial")

summary(twelve.china.econ.glm)
```
```{r}
chicago_2016 <- 
read_sav("2016public.sav") %>%
  as_factor() %>%
  select(Q5_23, Q5_24, Q45_6, Q50_5, 
         PPETHM, PPEDUCAT, PPAGE, Q1010, Q2_2,Q2_4) %>%
  rename(Q5_23 = china_econ_threat, Q5_24 = china_mil_threat, 
         Q45_6 = china_temp_therm, Q50_5 = china_influence, 
         PPEDUCAT = education, PPAGE = age, 
         PPETHM = race, Q1010 = party_id, Q2_2 = natl_news_interest,
         Q2_4 = usforeignaffairs_news_interest) %>%
  mutate(year = 2016) %>%
  mutate(china_mil_scale = case_when(china_mil_threat == "Critical threat" ~ 1,
                                     china_mil_threat == "Important but not critical threat" ~ 1,
                                     china_mil_threat == "Not an important threat" ~ 0,
                                     TRUE ~ NA_real_)) %>%
  mutate(china_econ_scale = case_when(china_econ_threat == "Critical threat" ~ 1,
                                     china_econ_threat == "Important but not critical threat" ~ 1,
                                     china_econ_threat == "Not an important threat" ~ 0,
                                     TRUE ~ NA_real_)) %>%
  mutate(education = case_when(education == "Less than high school" ~ 0,
                                     education == "High school" ~ 4,
                                     education == "Some college" ~ 6,
                                     education == "Bachelor's degree or higher" ~ 10,
                                     TRUE ~ NA_real_)) %>%
     mutate(race = case_when(race == "White, Non-Hispanic" ~ "White",
                                     race == "Black, Non-Hispanic" ~ "Black",
                                     race == "Other, Non-Hispanic" ~ "Other",
                                     race == "Hispanic" ~ "Hispanic",
                                     race == "2+ Races, Non-Hispanic" ~ "Other",
                                     TRUE ~ NA_character_)) %>%
       mutate(party_id = case_when(party_id == "Democrat" ~ "Democrat",
                                     party_id == "Republican" ~ "Republican",
                                     party_id == "Independent" ~ "Independent",
                                     TRUE ~ NA_character_)) %>%
  mutate(natl_news_interest = case_when(natl_news_interest == "Very interested" ~ 3,
                                     natl_news_interest == "Somewhat interested" ~ 2,
                                     natl_news_interest == "Hardly interested" ~ 1,
                                     natl_news_interest == "Don't follow the news" ~ 0,
                                     TRUE ~ NA_real_)) %>%
  mutate(usforeignaffairs_news_interest = case_when(usforeignaffairs_news_interest == "Very interested" ~ 3,
                                     usforeignaffairs_news_interest == "Somewhat interested" ~ 2,
                                     usforeignaffairs_news_interest == "Hardly interested" ~ 1,
                                     usforeignaffairs_news_interest == "Don't follow the news" ~ 0,
                                     TRUE ~ NA_real_)) %>%
  mutate_at(vars(age, china_influence, china_temp_therm), as.numeric)
  



sixteen.chicago.mil.glm <- glm(china_mil_scale ~ natl_news_interest + usforeignaffairs_news_interest + education + age + race + party_id, data = chicago_2016, family = "binomial")

summary(sixteen.chicago.mil.glm)

sixteen.chicago.econ.glm <- glm(china_econ_scale ~ natl_news_interest + usforeignaffairs_news_interest + education + age + race + party_id, data = chicago_2016, family = "binomial")

summary(sixteen.chicago.econ.glm)

sixteen.chicago.temp.lm <- lm(china_temp_therm ~ natl_news_interest + usforeignaffairs_news_interest + education + age + race + party_id, data = chicago_2016)

summary(sixteen.chicago.temp.lm)

sixteen.chicago.influence.lm <- lm(china_influence ~ natl_news_interest + usforeignaffairs_news_interest + education + age + race + party_id, data = chicago_2016)

summary(sixteen.chicago.influence.lm)
```

```{r}
chicago_2017 <- 
read_sav("2017public.sav") %>%
  as_factor() %>%
  select(Q2B, Q130_9, Q12_2, Q50_5, Q80_2, Q5_NEW_5_3,
         PPETHM, PPEDUCAT, PPAGE, Q1010) %>%
  rename(Q2B = main_media_source, Q130_9 = trust_media_do_good, 
         Q12_2 = china_world_responsible, Q50_5 = china_influence, 
         Q80_2 = china_fair_trade, Q5_NEW_5_3 = china_rise_threat,
         PPEDUCAT = education, PPAGE = age, 
         PPETHM = race, Q1010 = party_id) %>%
  mutate(year = 2016) %>%
  mutate(china_fair_trade_scale = case_when(china_fair_trade == "Practice unfair trade" ~ 1,
                                     china_fair_trade == "Practice fair trade" ~ 0,
                                     TRUE ~ NA_real_)) %>%
  mutate(china_rise_threat_scale = case_when(china_rise_threat == "Critical threat" ~ 1,
                                     china_rise_threat == "Important but not critical threat" ~ 1,
                                     china_rise_threat == "Not an important threat" ~ 0,
                                     TRUE ~ NA_real_)) %>%
  mutate(education = case_when(education == "Less than high school" ~ 0,
                                     education == "High school" ~ 4,
                                     education == "Some college" ~ 6,
                                     education == "Bachelor's degree or higher" ~ 10,
                                     TRUE ~ NA_real_)) %>%
     mutate(race = case_when(race == "White, Non-Hispanic" ~ "White",
                                     race == "Black, Non-Hispanic" ~ "Black",
                                     race == "Other, Non-Hispanic" ~ "Other",
                                     race == "Hispanic" ~ "Hispanic",
                                     race == "2+ Races, Non-Hispanic" ~ "Other",
                                     TRUE ~ NA_character_)) %>%
       mutate(main_media_source = case_when(main_media_source == "Newspapers and news magazines" ~ "Newspapers and news magazines",
                                     main_media_source == "Radio" ~ "Radio",
                                     main_media_source == "Network TV news broadcasts (For example: ABC, CBS, or NBC)" ~ "Network TV news broadcasts (For example: ABC, CBS, or NBC)",
                                     main_media_source == "Cable TV news broadcasts (For example: CNN, Fox News, or MSNBC)" ~ "Cable TV news broadcasts (For example: CNN, Fox News, or MSNBC)",
                                     main_media_source == "Blogs and other websites" ~ "Blogs and other websites",
                                     main_media_source == "Facebook, Twitter and other social media" ~ "Facebook, Twitter and other social media",
                                     TRUE ~ NA_character_)) %>%
         mutate(trust_media_do_good = case_when(trust_media_do_good == "A great deal" ~ "A great deal",
                                     trust_media_do_good == "A fair amount" ~ "A fair amount",
                                     trust_media_do_good == "Not very much" ~ "Not very much",
                                     trust_media_do_good == "No confidence at all" ~ "No confidence at all",
                                     TRUE ~ NA_character_)) %>%
       mutate(party_id = case_when(party_id == "Democrat" ~ "Democrat",
                                     party_id == "Republican" ~ "Republican",
                                     party_id == "Independent" ~ "Independent",
                                     TRUE ~ NA_character_)) %>%
  mutate_at(vars(age, china_influence, china_world_responsible), as.numeric)
  
# chicago_2017$main_media_source <- relevel(chicago_2017$main_media_source, "Newspapers and news magazines")
chicago_2017$main_media_source <- factor(chicago_2017$main_media_source, levels = c("Newspapers and news magazines", "Radio", "Network TV news broadcasts (For example: ABC, CBS, or NBC)", "Cable TV news broadcasts (For example: CNN, Fox News, or MSNBC)", "Blogs and other websites", "Facebook, Twitter and other social media" ~ "Facebook, Twitter and other social media"))

chicago_2017$trust_media_do_good <- factor(chicago_2017$trust_media_do_good, levels = c("A great deal", "A fair amount", "Not very much", "No confidence at all"))

seventeen.chicago.trade.glm <- glm(china_fair_trade ~ main_media_source + education + age + race + party_id, data = chicago_2017, family = "binomial")

summary(seventeen.chicago.trade.glm)

seventeen.chicago.threat.glm <- glm(china_rise_threat_scale ~ main_media_source + education + age + race + party_id, data = chicago_2017, family = "binomial")

summary(seventeen.chicago.threat.glm)

seventeen.chicago.responsible.lm <- lm(china_world_responsible ~ main_media_source + education + age + race + party_id, data = chicago_2017)

summary(seventeen.chicago.responsible.lm)

seventeen.chicago.influence.lm <- lm(china_influence ~ main_media_source + education + age + race + party_id, data = chicago_2017)

summary(seventeen.chicago.influence.lm)

two.seventeen.chicago.trade.glm <- glm(china_fair_trade ~ trust_media_do_good + education + age + race + party_id, data = chicago_2017, family = "binomial")

summary(two.seventeen.chicago.trade.glm)

two.seventeen.chicago.threat.glm <- glm(china_rise_threat_scale ~ trust_media_do_good + education + age + race + party_id, data = chicago_2017, family = "binomial")

summary(two.seventeen.chicago.threat.glm)

two.seventeen.chicago.responsible.lm <- lm(china_world_responsible ~ trust_media_do_good + education + age + race + party_id, data = chicago_2017)

summary(two.seventeen.chicago.responsible.lm)

two.seventeen.chicago.influence.lm <- lm(china_influence ~ trust_media_do_good + education + age + race + party_id, data = chicago_2017)

summary(two.seventeen.chicago.influence.lm)
```

